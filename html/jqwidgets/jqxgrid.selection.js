/*
jQWidgets v2.5.0 (2012-Oct-17)
Copyright (c) 2011-2012 jQWidgets.
License: http://jqwidgets.com/license/
*/

(function(a){a.extend(a.jqx._jqxGrid.prototype,{selectrow:function(b,c){this._applyrowselection(b,true,c)},selectallrows:function(){this.clearselection(false);var c=this.dataview.records.length;if(c>0){for(var b=0;b<c;b++){if(b<c-1){this.selectrow(b,false)}else{this.selectrow(b,true)}}}},unselectrow:function(b,c){this._applyrowselection(b,false,c)},selectcell:function(c,b){this._applycellselection(c,b,true)},unselectcell:function(c,b){this._applycellselection(c,b,false)},clearselection:function(c){this.selectedrowindex=-1;for(var b=0;b<this.selectedrowindexes.length;b++){this._raiseEvent(3,{rowindex:this.selectedrowindexes[b]})}this.selectedrowindexes=new Array();this.selectedcells=new Array();if(!c){return}this._renderrows(this.virtualsizeinfo)},getselectedrowindex:function(){return this.selectedrowindex},getselectedrowindexes:function(){return this.selectedrowindexes},getselectedcell:function(){return this.selectedcell},getselectedcells:function(){var b=new Array();for(obj in this.selectedcells){b[b.length]=this.selectedcells[obj]}return b},_applyrowselection:function(c,b,g,e,f){if(c==null){return false}var d=this.selectedrowindex;if(this.selectionmode=="singlerow"){if(b){this._raiseEvent(2,{rowindex:c,row:this.getrowdata(c)})}else{this._raiseEvent(3,{rowindex:c,row:this.getrowdata(c)})}this._raiseEvent(3,{rowindex:d});this.selectedrowindexes=new Array();this.selectedcells=new Array()}if(e==true){this.selectedrowindexes=new Array()}var h=this.selectedrowindexes.indexOf(c);if(b){this.selectedrowindex=c;if(this.selectedrowindexes.indexOf(c)==-1){this.selectedrowindexes.push(c);if(this.selectionmode!="singlerow"){this._raiseEvent(2,{rowindex:c,row:this.getrowdata(c)})}}else{if(this.selectionmode=="multiplerows"){this.selectedrowindexes.splice(h,1);this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(c)});this.selectedrowindex=this.selectedrowindexes.length>0?this.selectedrowindexes[this.selectedrowindexes.length-1]:-1}}}else{if(h>=0||this.selectionmode=="singlerow"||this.selectionmode=="multiplerowsextended"){this.selectedrowindexes.splice(h,1);this._raiseEvent(3,{rowindex:this.selectedrowindex,row:this.getrowdata(c)});this.selectedrowindex=-1}}if(g==undefined||g){this._rendervisualrows()}return true},_applycellselection:function(d,i,c,h){if(d==null){return false}if(i==null){return false}var e=this.selectedrowindex;if(this.selectionmode=="singlecell"){var g=this.selectedcell;if(g!=null){this._raiseEvent(16,{rowindex:g.rowindex,datafield:g.datafield})}this.selectedcells=new Array()}if(this.selectionmode=="multiplecellsextended"){var g=this.selectedcell;if(g!=null){this._raiseEvent(16,{rowindex:g.rowindex,datafield:g.datafield})}}var f=d+"_"+i;var b={rowindex:d,datafield:i};if(c){this.selectedcell=b;if(!this.selectedcells[f]){this.selectedcells[f]=b;this.selectedcells.length++;this._raiseEvent(15,b)}else{if(this.selectionmode=="multiplecells"){this.selectedcells[f]=undefined;this.selectedcells.length--;this._raiseEvent(16,b)}}}else{this.selectedcells[f]=undefined;this.selectedcells.length--;this._raiseEvent(16,b)}if(h==undefined||h){this._rendervisualrows()}return true},_getcellindex:function(b){var c=-1;a.each(this.selectedcells,function(){c++;if(this[b]){return false}});return c},_clearhoverstyle:function(){if(undefined==this.hoveredrow||this.hoveredrow==-1){return}if(this.vScrollInstance.isScrolling()){return}if(this.hScrollInstance.isScrolling()){return}var b=this.table.find(".jqx-grid-cell-hover");if(b.length>0){b.removeClass(this.toTP("jqx-grid-cell-hover"));b.removeClass(this.toTP("jqx-fill-state-hover"))}this.hoveredrow=-1},_clearselectstyle:function(){var k=this.table[0].rows.length;var p=this.table[0].rows;var l=this.toTP("jqx-grid-cell-selected");var c=this.toTP("jqx-fill-state-pressed");var m=this.toTP("jqx-grid-cell-hover");var h=this.toTP("jqx-fill-state-hover");for(var g=0;g<k;g++){var b=p[g];var f=b.cells.length;var o=b.cells;for(var e=0;e<f;e++){var d=o[e];var n=a(d);if(d.className.indexOf("jqx-grid-cell-selected")!=-1){n.removeClass(l);n.removeClass(c)}if(d.className.indexOf("jqx-grid-cell-hover")!=-1){n.removeClass(m);n.removeClass(h)}}}},_selectpath:function(m,e){var l=this;var i=this._lastClickedCell?Math.min(this._lastClickedCell.row,m):0;var k=this._lastClickedCell?Math.max(this._lastClickedCell.row,m):0;if(i<=k){var h=this._getcolumnindex(this._lastClickedCell.column);var g=this._getcolumnindex(e);var f=Math.min(h,g);var d=Math.max(h,g);this.selectedcells=new Array();for(var b=i;b<=k;b++){for(var j=f;j<=d;j++){this._applycellselection(b,l._getcolumnat(j).datafield,true,false)}}this._rendervisualrows()}},_selectrowpath:function(e){if(this.selectionmode=="multiplerowsextended"){var c=this;var b=this._lastClickedCell?Math.min(this._lastClickedCell.row,e):0;var f=this._lastClickedCell?Math.max(this._lastClickedCell.row,e):0;if(b<=f){this.selectedrowindexes=new Array();for(var d=b;d<=f;d++){this._applyrowselection(d,true,false)}this._rendervisualrows()}}},_selectrowwithmouse:function(p,l,e,f,d,j){var q=l.row;if(q==undefined){return}var g=l.index;var c=this.hittestinfo[g].visualrow;if(this.hittestinfo[g].details){return}var i=c.cells[0].className;if(q.group){return}if(this.selectionmode=="multiplerows"||this.selectionmode=="multiplecells"||(this.selectionmode.indexOf("multiple")!=-1&&(j==true||d==true))){var n=e.indexOf(q.boundindex)!=-1;var m=q.boundindex+"_"+f;if(this.selectionmode.indexOf("cell")!=-1){var o=this.selectedcells[m]!=undefined;if(this.selectedcells[m]!=undefined&&o){this._selectcellwithstyle(p,false,g,f,c)}else{this._selectcellwithstyle(p,true,g,f,c)}if(j&&this._lastClickedCell){this._selectpath(q.boundindex,f);this.mousecaptured=false;if(this.selectionarea.css("visibility")=="visible"){this.selectionarea.css("visibility","hidden")}}}else{if(n){this._selectrowwithstyle(p,c,false,f)}else{this._selectrowwithstyle(p,c,true,f)}if(j&&this._lastClickedCell){this.selectedrowindexes=new Array();var h=this._lastClickedCell?Math.min(this._lastClickedCell.row,q.boundindex):0;var k=this._lastClickedCell?Math.max(this._lastClickedCell.row,q.boundindex):0;for(var b=h;b<=k;b++){this._applyrowselection(b,true,false,false)}this._rendervisualrows()}}}else{this._clearselectstyle();this._selectrowwithstyle(p,c,true,f);if(this.selectionmode.indexOf("cell")!=-1){this._selectcellwithstyle(p,true,g,f,c)}}if(!j){this._lastClickedCell={row:q.boundindex,column:f}}},_selectcellwithstyle:function(d,c,g,f,e){var b=a(e.cells[d._getcolumnindex(f)]);b.removeClass(this.toTP("jqx-grid-cell-hover"));b.removeClass(this.toTP("jqx-fill-state-hover"));if(c){b.addClass(this.toTP("jqx-grid-cell-selected"));b.addClass(this.toTP("jqx-fill-state-pressed"))}else{b.removeClass(this.toTP("jqx-grid-cell-selected"));b.removeClass(this.toTP("jqx-fill-state-pressed"))}},_selectrowwithstyle:function(e,h,b,j){var c=h.cells.length;var f=0;if(e.rowdetails&&e.showrowdetailscolumn){f=1}for(var g=f;g<c;g++){var d=h.cells[g];if(b){a(d).removeClass(this.toTP("jqx-grid-cell-hover"));a(d).removeClass(this.toTP("jqx-fill-state-hover"));if(e.selectionmode.indexOf("cell")==-1){a(d).addClass(this.toTP("jqx-grid-cell-selected"));a(d).addClass(this.toTP("jqx-fill-state-pressed"))}}else{a(d).removeClass(this.toTP("jqx-grid-cell-hover"));a(d).removeClass(this.toTP("jqx-grid-cell-selected"));a(d).removeClass(this.toTP("jqx-fill-state-hover"));a(d).removeClass(this.toTP("jqx-fill-state-pressed"))}}},_handlemousemoveselection:function(b,o){if((o.selectionmode=="multiplerowsextended"||o.selectionmode=="multiplecellsextended")&&o.mousecaptured){var d=this.showheader?this.columnsheader.height()+2:0;var c=this._groupsheader()?this.groupsheader.height():0;var g=this.showtoolbar?this.toolbarheight:0;c+=g;var f=this.host.offset();if(this.hasTransform){f=a.jqx.utilities.getOffset(this.host)}var l=b.pageX;var k=b.pageY-c;var n=parseInt(this.columnsheader.offset().top);if(this.hasTransform){n=a.jqx.utilities.getOffset(this.columnsheader).top}var e=d;if(k<e){k=e+5}var m=parseInt(Math.min(o.mousecaptureposition.left,l));var j=-5+parseInt(Math.min(o.mousecaptureposition.top,k));var h=parseInt(Math.abs(o.mousecaptureposition.left-l));var i=parseInt(Math.abs(o.mousecaptureposition.top-k));m-=f.left;j-=f.top;this.selectionarea.css("visibility","visible");this.selectionarea.width(h);this.selectionarea.height(i);this.selectionarea.css("left",m);this.selectionarea.css("top",j)}},_handlemouseupselection:function(u,o){if(this.selectionarea.css("visibility")!="visible"){o.mousecaptured=false;return true}if(o.mousecaptured&&(o.selectionmode=="multiplerowsextended"||o.selectionmode=="multiplecellsextended")){o.mousecaptured=false;if(this.selectionarea.css("visibility")=="visible"){this.selectionarea.css("visibility","hidden");var w=this.showheader?this.columnsheader.height()+2:0;var p=this._groupsheader()?this.groupsheader.height():0;var B=this.showtoolbar?this.toolbarheight:0;p+=B;var C=this.selectionarea.offset();var c=this.host.offset();if(this.hasTransform){c=a.jqx.utilities.getOffset(this.host);C=a.jqx.utilities.getOffset(this.selectionarea)}var n=C.left-c.left;var k=C.top-w-c.top-p;var s=k;var g=n+this.selectionarea.width();var D=n;var l=new Array();var e=new Array();if(o.selectionmode=="multiplerowsextended"){while(k<s+this.selectionarea.height()){var b=this._hittestrow(n,k);var f=b.row;var h=b.index;if(h!=-1){if(!e[h]){e[h]=true;l[l.length]=b}}k+=20}var s=0;a.each(l,function(){var i=this;var m=this.row;if(o.selectionmode!="none"&&o._selectrowwithmouse){if(u.ctrlKey){o._applyrowselection(m.boundindex,true,false,false)}else{if(s==0){o._applyrowselection(m.boundindex,true,false,true)}else{o._applyrowselection(m.boundindex,true,false,false)}}s++}})}else{var r=o.hScrollInstance;var t=r.value;var q=o.table[0].rows[0];var j=o.selectionarea.height();if(!u.ctrlKey&&j>0){o.selectedcells=new Array()}var A=j;while(k<s+A){var b=o._hittestrow(n,k);var f=b.row;var h=b.index;if(h!=-1){if(!e[h]){e[h]=true;for(var v=0;v<q.cells.length;v++){var d=parseInt(a(o.columnsrow[0].cells[v]).css("left"))-t;var z=d+a(o.columnsrow[0].cells[v]).width();if((D>=d&&D<=z)||(g>=d&&g<=z)||(d>=D&&d<=g)){o._applycellselection(f.boundindex,o._getcolumnat(v).datafield,true,false)}}}}k+=5}}if(o.autosavestate){if(o.savestate){o.savestate()}}o._renderrows(o.virtualsizeinfo)}}},selectprevcell:function(e,c){var f=this._getcolumnindex(c);var b=this.columns.records.length;var d=this._getprevvisiblecolumn(f);if(d!=null){this.clearselection();this.selectcell(e,d.datafield)}},selectnextcell:function(e,d){var f=this._getcolumnindex(d);var c=this.columns.records.length;var b=this._getnextvisiblecolumn(f);if(b!=null){this.clearselection();this.selectcell(e,b.datafield)}},_getfirstvisiblecolumn:function(){var b=this;var e=this.columns.records.length;for(var c=0;c<e;c++){var d=this.columns.records[c];if(!d.hidden&&d.datafield!=null){return d}}return null},_getlastvisiblecolumn:function(){var b=this;var e=this.columns.records.length;for(var c=e-1;c>=0;c--){var d=this.columns.records[c];if(!d.hidden&&d.datafield!=null){return d}}return null},_handlekeydown:function(t,m){if(m.editcell){return true}if(m.selectionmode=="none"){return true}if(m.showfilterrow&&m.filterable){if(this.filterrow){if(a(t.target).ischildof(this.filterrow)){return true}}}if(m.pageable){if(a(t.target).ischildof(this.pager)){return true}}if(this.showtoolbar){if(a(t.target).ischildof(this.toolbar)){return true}}if(this.showstatusbar){if(a(t.target).ischildof(this.statusbar)){return true}}var y=t.charCode?t.charCode:t.keyCode?t.keyCode:0;var l=false;if(t.altKey){return true}var i=Math.round(m._gettableheight());var r=Math.round(i/m.rowsheight);var e=m.getdatainformation();switch(m.selectionmode){case"singlecell":case"multiplecells":case"multiplecellsextended":var z=m.getselectedcell();if(z!=null){var d=this.getrowvisibleindex(z.rowindex);var f=d;var k=z.datafield;var o=m._getcolumnindex(k);var b=m.columns.records.length;var p=function(D,B,C){var A=function(H,E){var G=m.dataview.loadedrecords[H];if(G!=undefined&&E!=null){if(C||C==undefined){m.clearselection()}var F=G.boundindex;m.selectcell(F,E);m._oldselectedcell=m.selectedcell;l=true;m.ensurecellvisible(H,E);return true}return false};if(!A(D,B)){m.ensurecellvisible(D,B);A(D,B);if(m.virtualmode){m.host.focus()}}if(t.shiftKey&&y!=9){if(m.selectionmode=="multiplecellsextended"){if(m._lastClickedCell){m._selectpath(D,B);m.selectedcell={rowindex:D,datafield:B};return}}}else{if(!t.shiftKey){m._lastClickedCell={row:D,column:B}}}};var u=t.shiftKey&&m.selectionmode!="singlecell"&&m.selectionmode!="multiplecells";var v=function(){p(0,k,!u)};var g=function(){var A=e.rowscount-1;p(A,k,!u)};var c=y==9&&!t.shiftKey;var h=y==9&&t.shiftKey;if(c||h){u=false}var j=t.ctrlKey;if(j&&y==37){var x=m._getfirstvisiblecolumn(o);if(x!=null){p(f,x.datafield)}}else{if(j&&y==39){var n=m._getlastvisiblecolumn(o);if(n!=null){p(f,n.datafield)}}else{if(y==39||c){var q=m._getnextvisiblecolumn(o);if(q!=null){p(f,q.datafield,!u)}else{if(!c){l=true}}}else{if(y==37||h){var x=m._getprevvisiblecolumn(o);if(x!=null){p(f,x.datafield,!u)}else{if(!h){l=true}}}else{if(y==36){v()}else{if(y==35){g()}else{if(y==33){if(f-r>=0){var w=f-r;p(w,k,!u)}else{v()}}else{if(y==34){if(e.rowscount>f+r){var w=f+r;p(w,k,!u)}else{g()}}else{if(y==38){if(j){v()}else{if(f>0){p(f-1,k,!u)}else{l=true}}}else{if(y==40){if(j){g()}else{if(e.rowscount>f+1){p(f+1,k,!u)}else{l=true}}}}}}}}}}}}}break;case"singlerow":case"multiplerows":case"multiplerowsextended":var f=m.getselectedrowindex();if(f==null||f==-1){return true}f=this.getrowvisibleindex(f);var s=function(B,C){var A=function(F){var H=m.dataview.loadedrecords[F];if(H!=undefined){var G=H.boundindex;var E=m.selectedrowindex;if(C||C==undefined){m.clearselection()}m.selectedrowindex=E;m.selectrow(G,false);var D=m.ensurerowvisible(F);if(!D){m._rendervisualrows()}l=true;return true}return false};if(!A(B)){m.ensurerowvisible(B);A(B,C);if(m.virtualmode){m.host.focus()}}if(t.shiftKey&&y!=9){if(m.selectionmode=="multiplerowsextended"){if(m._lastClickedCell){m._selectrowpath(B);m.selectedrowindex=B;return}}}else{if(!t.shiftKey){m._lastClickedCell={row:B}}}};var u=t.shiftKey&&m.selectionmode!="singlerow"&&m.selectionmode!="multiplerows";var v=function(){s(0,!u)};var g=function(){var A=e.rowscount-1;s(A,!u)};var j=t.ctrlKey;if(y==36||(j&&y==38)){v()}else{if(y==35||(j&&y==40)){g()}else{if(y==33){if(f-r>=0){var w=f-r;s(w,!u)}else{v()}}else{if(y==34){if(e.rowscount>f+r){var w=f+r;s(w,!u)}else{g()}}else{if(y==38){if(f>0){s(f-1,!u)}else{l=true}}else{if(y==40){if(e.rowscount>f+1){s(f+1,!u)}else{l=true}}}}}}}break}if(l){if(m.autosavestate){if(m.savestate){m.savestate()}}if(m.editcell!=null&&m.endcelledit){m.endcelledit(m.editcell.row,m.editcell.column,true,true)}return false}return true},_handlemousemove:function(r,m){if(m.vScrollInstance.isScrolling()){return}if(m.hScrollInstance.isScrolling()){return}var t;var n;var e;var l;var k;if(m.enablehover||m.selectionmode=="multiplerows"){t=this.showheader?this.columnsheader.height()+2:0;n=this._groupsheader()?this.groupsheader.height():0;var v=this.showtoolbar?this.toolbarheight:0;n+=v;e=this.host.offset();if(this.hasTransform){e=a.jqx.utilities.getOffset(this.host)}l=r.pageX-e.left;k=r.pageY-t-e.top-n}if(m.selectionmode=="multiplerowsextended"||m.selectionmode=="multiplecellsextended"){if(m.mousecaptured==true){return}}if(m.enablehover){if(m.disabled){return}if(this.vScrollInstance.isScrolling()||this.hScrollInstance.isScrolling()){return}var c=this._hittestrow(l,k);if(!c){return}var g=c.row;var h=c.index;if(this.hoveredrow!=-1&&h!=-1&&this.hoveredrow==h&&this.selectionmode.indexOf("cell")==-1){return}this._clearhoverstyle();if(h==-1||g==undefined){return}var o=this.hittestinfo[h].visualrow;if(o==null){return}if(this.hittestinfo[h].details){return}var w=0;if(m.rowdetails&&m.showrowdetailscolumn){w=1}if(o.cells.length==0){return}var j=o.cells[w].className;if(g.group||j.indexOf("jqx-grid-cell-selected")!=-1){return}this.hoveredrow=h;if(this.selectionmode.indexOf("cell")!=-1){var d=-1;var p=this.hScrollInstance;var q=p.value;for(var s=0;s<o.cells.length;s++){var f=parseInt(a(this.columnsrow[0].cells[s]).css("left"))-q;var u=f+a(this.columnsrow[0].cells[s]).width();if(u>=l&&l>=f){d=s;break}}if(d!=-1){var b=o.cells[d];if(b.className.indexOf("jqx-grid-cell-selected")==-1){if(b.className.indexOf("jqx-grid-group")==-1){a(b).addClass(this.toTP("jqx-grid-cell-hover"));a(b).addClass(this.toTP("jqx-fill-state-hover"))}}}return}for(var s=w;s<o.cells.length;s++){var b=o.cells[s];if(b.className.indexOf("jqx-grid-group")==-1){a(b).addClass(this.toTP("jqx-grid-cell-hover"));a(b).addClass(this.toTP("jqx-fill-state-hover"))}}}else{return true}}})})(jQuery);