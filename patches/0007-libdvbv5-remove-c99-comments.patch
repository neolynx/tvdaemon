From bb76e71a42beec14391f0d5f86c1db87e26906de Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Andr=C3=A9=20Roth?= <neolynx@gmail.com>
Date: Wed, 8 Jan 2014 20:45:59 +0100
Subject: [PATCH 07/40] libdvbv5: remove c99 comments
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Andr√© Roth <neolynx@gmail.com>
---
 lib/libdvbv5/descriptors/desc_service_list.c |    4 +++-
 lib/libdvbv5/dvb-file.c                      |   21 +++++++++++----------
 lib/libdvbv5/dvb-log.c                       |    2 +-
 lib/libdvbv5/dvb-sat.c                       |    2 --
 lib/libdvbv5/dvb-scan.c                      |    2 ++
 5 files changed, 17 insertions(+), 14 deletions(-)

diff --git a/lib/libdvbv5/descriptors/desc_service_list.c b/lib/libdvbv5/descriptors/desc_service_list.c
index 36ecc95..153918e 100644
--- a/lib/libdvbv5/descriptors/desc_service_list.c
+++ b/lib/libdvbv5/descriptors/desc_service_list.c
@@ -23,6 +23,8 @@
 #include "descriptors.h"
 #include "dvb-fe.h"
 
+/* FIXME: implement */
+
 void dvb_desc_service_list_init(struct dvb_v5_fe_parms *parms, const uint8_t *buf, struct dvb_desc *desc)
 {
 	/*struct dvb_desc_service_list *slist = (struct dvb_desc_service_list *) desc;*/
@@ -38,7 +40,7 @@ void dvb_desc_service_list_init(struct dvb_v5_fe_parms *parms, const uint8_t *bu
 	/*}*/
 
 	/*return sizeof(struct dvb_desc_service_list) + slist->length + sizeof(struct dvb_desc_service_list_table);*/
-	//FIXME: make linked list
+	/* FIXME: make linked list */
 }
 
 void dvb_desc_service_list_print(struct dvb_v5_fe_parms *parms, const struct dvb_desc *desc)
diff --git a/lib/libdvbv5/dvb-file.c b/lib/libdvbv5/dvb-file.c
index e0cef34..34e3651 100644
--- a/lib/libdvbv5/dvb-file.c
+++ b/lib/libdvbv5/dvb-file.c
@@ -815,20 +815,21 @@ static char *dvb_vchannel(struct dvb_table_nit *nit, uint16_t service_id)
 	if (!nit)
 		return NULL;
 
-for( struct dvb_desc_logical_channel *desc = (struct dvb_desc_logical_channel *) nit->descriptor; desc; desc = (struct dvb_desc_logical_channel *) desc->next ) \
+	/* FIXME: use dvb_desc_find(struct dvb_desc_logical_channel, desc, nit, logical_channel_number_descriptor) { */
+	for( struct dvb_desc_logical_channel *desc = (struct dvb_desc_logical_channel *) nit->descriptor; desc; desc = (struct dvb_desc_logical_channel *) desc->next ) {
 		if(desc->type == logical_channel_number_descriptor) {
-//	dvb_desc_find(struct dvb_desc_logical_channel, desc, nit, logical_channel_number_descriptor) {
-		struct dvb_desc_logical_channel *d = (void *)desc;
+			struct dvb_desc_logical_channel *d = (void *)desc;
 
-		size_t len;
+			size_t len;
 
-		len = d->length / sizeof(d->lcn);
+			len = d->length / sizeof(d->lcn);
 
-		for (i = 0; i < len; i++) {
-			if (service_id == d->lcn[i].service_id) {
-				asprintf(&buf, "%d.%d",
-					d->lcn[i].logical_channel_number, i);
-				return buf;
+			for (i = 0; i < len; i++) {
+				if (service_id == d->lcn[i].service_id) {
+					asprintf(&buf, "%d.%d",
+						d->lcn[i].logical_channel_number, i);
+					return buf;
+				}
 			}
 		}
 	}
diff --git a/lib/libdvbv5/dvb-log.c b/lib/libdvbv5/dvb-log.c
index 87d92f2..137b188 100644
--- a/lib/libdvbv5/dvb-log.c
+++ b/lib/libdvbv5/dvb-log.c
@@ -44,7 +44,7 @@ static const struct loglevel {
 
 void dvb_default_log(int level, const char *fmt, ...)
 {
-	if(level > sizeof(loglevels) / sizeof(struct loglevel) - 2) // ignore LOG_COLOROFF as well
+	if(level > sizeof(loglevels) / sizeof(struct loglevel) - 2) /* ignore LOG_COLOROFF as well */
 		level = LOG_INFO;
 	va_list ap;
 	va_start(ap, fmt);
diff --git a/lib/libdvbv5/dvb-sat.c b/lib/libdvbv5/dvb-sat.c
index e307a3d..52dcffb 100644
--- a/lib/libdvbv5/dvb-sat.c
+++ b/lib/libdvbv5/dvb-sat.c
@@ -214,8 +214,6 @@ static void dvbsat_diseqc_prep_frame_addr(struct diseqc_cmd *cmd,
 	cmd->address = diseqc_addr[type];
 }
 
-//struct dvb_v5_fe_parms *parms; // legacy code, used for parms->fd, FIXME anyway
-
 /* Inputs are numbered from 1 to 16, according with the spec */
 static int dvbsat_diseqc_write_to_port_group(struct dvb_v5_fe_parms *parms, struct diseqc_cmd *cmd,
 					     int high_band,
diff --git a/lib/libdvbv5/dvb-scan.c b/lib/libdvbv5/dvb-scan.c
index 1bb227a..84c0f86 100644
--- a/lib/libdvbv5/dvb-scan.c
+++ b/lib/libdvbv5/dvb-scan.c
@@ -113,6 +113,8 @@ int dvb_read_section_with_id(struct dvb_v5_fe_parms *parms, int dmx_fd,
 	*table = NULL;
 
 	// FIXME: verify known table
+	if (dvb_table_initializers[tid].size == 0) {
+	}
 
 	if (dvb_set_section_filter(dmx_fd, pid, 1, &tid, &mask, NULL,
 				   DMX_IMMEDIATE_START | DMX_CHECK_CRC))
-- 
1.7.10.4

